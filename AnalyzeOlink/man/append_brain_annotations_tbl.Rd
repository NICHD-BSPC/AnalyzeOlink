% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/annotations.R
\name{append_brain_annotations_tbl}
\alias{append_brain_annotations_tbl}
\title{Append Human Protein Atlas (HPA) brain annotations to results}
\usage{
append_brain_annotations_tbl(res, data_dir)
}
\arguments{
\item{res}{Named list of per-contrast results; each element contains an \verb{$anova} table
with a \code{GeneID} column to join on.}

\item{data_dir}{Directory to cache HPA downloads and extracted TSVs (created if missing).}
}
\value{
A list with elements:
\itemize{
\item \code{res}: updated \code{res} where each \verb{$anova} gained the HPA columns.
\item \code{hpa}: raw (filtered) HPA IHC table.
\item \code{hpa_summary}: per-gene summary used for annotation joins.
}
}
\description{
Downloads and processes HPA Normal Tissue IHC data and tissue–organ mapping,
computes brain-focused annotation metrics per gene, and appends these to each
contrast table in \code{res}. Returns the updated \code{res} alongside the raw HPA IHC
table and a per-gene summary used for joins.
}
\details{
Key outputs added per gene:
\itemize{
\item \strong{BrainDetected}: binary; any brain tissue Level \> 0.
\item \strong{BrainSpecific}: binary; top organ is Brain \strong{and} organ-level tau ≥ 0.9.
\item \strong{TauBrainSpecificity / TauOrganSpecificity}: organ-level tau (0–1), with a
brain-specific copy set to 0 when Brain is not the top organ.
\item \strong{Regional grades} \emph{(0–3)}: Cerebellum, Caudate, CerebralCortex, Hippocampus,
and \strong{Purkinje} (cell-type in Cerebellum).
\item \strong{BrainPurkinjeSpecific}: Purkinje grade only when \strong{BrainSpecific == 1}, else 0.
}

Data sources (HPA TSVs) are cached under \code{data_dir}:
\itemize{
\item \code{normal_ihc_data.tsv.zip}, \code{normal_ihc_tissues.tsv.zip}
}
}
\seealso{
\code{\link[=add_extra_hpa_data]{add_extra_hpa_data()}}
}
