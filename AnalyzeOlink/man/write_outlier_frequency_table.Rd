% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/assumptions.R
\name{write_outlier_frequency_table}
\alias{write_outlier_frequency_table}
\title{Residual outlier frequency tables (per contrast)}
\usage{
write_outlier_frequency_table(
  res_list,
  outdir,
  pval_bin = c(0, 0.1),
  k = 1.5,
  print_plot = FALSE
)
}
\arguments{
\item{res_list}{Named list from \code{run_tests()}; each element has \verb{$anova}
with \code{Assay}, \code{Panel}, \code{SW_pval}, and list-column \code{resids} (names are \code{SampleID}).}

\item{outdir}{String; output directory for workbooks/plots (must exist).}

\item{pval_bin}{Numeric length-2 vector giving the open/closed interval
\verb{(low, high]} for selecting proteins (default \code{c(0, 0.1)}).}

\item{k}{Numeric selectivity constant for Tukey fences (default \code{1.5}).}

\item{print_plot}{Logical; if \code{TRUE}, write Excel + plots and return frequency tables.}
}
\value{
If \code{print_plot = FALSE}, returns (invisibly) \code{outlier_list} where
\code{outlier_list[[contrast]][[SampleID]]} is a character vector of \code{"Assay_Panel"}.
If \code{print_plot = TRUE}, returns (invisibly) a named list of frequency tables.
}
\description{
Selects proteins whose Shapiro–Wilk p-values fall in \code{pval_bin}, flags
residual outliers per protein via a Tukey IQR rule (\code{k} × IQR), and returns
a nested list of outliers. If \code{print_plot = TRUE}, also writes a per-contrast
frequency table to Excel plus an optional bar plot, and returns the list of
frequency tables.
}
